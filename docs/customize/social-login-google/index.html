<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Google Authentication - Gluu Docs</title>
  

  <link rel="shortcut icon" href="../../img/gluu_favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Gluu Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
			
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Introduction</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../introduction/">Summary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../introduction/history/">History</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../introduction/design/">Design Goals</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../introduction/architecture/">Gluu Server Architecture</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Install Gluu CE</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/">Preparing VM</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/ubuntu/">Ubuntu 14.04</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/ubuntu-xenial/">Ubuntu 16.04</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/centos/">CentOS 6.x</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/centos7/">CentOS 7.2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/rhel/">RHEL 6.x</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/rhel7/">RHEL 7</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/debian/">Debian</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/setup_py/">Setup Script Options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/azure/">Microsoft Azure Guide</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/linode/">Linode VM Guide</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Upgrade/Update Gluu CE</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/upgrading/">Upgrade from 2.4.x</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deployment/updating/">Update Gluu CE 2.4.4</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Cluster Configuration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cluster/csync-installation/">Requirements: csync2 Installation</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cluster/">Clustering with CE</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Gluu Server GUI</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../oxtrust/configuration/">Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/oxtrust-properties/">OxTrust JSON Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/oxauth-properties/">OxAuth JSON Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/outbound-saml/">SAML</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/openid-connect/">OpenID Connect</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/uma/">UMA</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../oxtrust/users/">Users</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../oxtrust/personal/">Personal</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>User Managment</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cache-refresh/">Sync LDAP/AD</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-management/xlsfile/">Import XLS File</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cache-refresh/register/">Register Users</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../cache-refresh/reset-password/">Reset User Password</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-management/scim/">SCIM 2.0 Add/Delete User</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Authentication</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/intro/">Intro</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/duo/">DUO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/u2f/">U2F</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/oxpush2/">oxPush2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/wikid/">Wikid</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../multi-factor/cert/">Certificate</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Google Authentication</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#configure-google">Configure Google</a></li>
                
                    <li><a class="toctree-l4" href="#configure-gluu-server">Configure Gluu Server</a></li>
                
                    <li><a class="toctree-l4" href="#testing">Testing</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>FAQ</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/general/">General</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/troubleshooting/">Troubleshooting</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>How To</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../how-to/automate-schema/">Automate Custom Schema</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/scimuma-howto/">Protect SCIM endpoints with UMA</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-management/lock-user/">Lock User on Failed Attempt</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../how-to/uma-demo/">Configure UMA</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../how-to/update-certificate/">Update Gluu Server Certificates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../how-to/saml_proxy_end_to_end/">Inbound SAML End to End Testing</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Customize Gluu Server</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../design/">Design Customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../script/">Behaviour Customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../auth-script/">Custom Script How-To</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../attributes/">Custom Attributes</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Supported Protocols</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/outbound-saml/">Outbound SAML</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/inbound-saml/">Inbound SAML</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/openid-connect/">OpenID Connect</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/uma/">UMA</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/oauth2grants/">OAuth2</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/scim-1.1/">SCIM 1.1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/scim-2.0/">SCIM 2.0</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>SP / RP Integration Modules</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/oxd/">oxd OAuth2 Client Software </a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/ubuntu-installation/">OpenID Connect RP in Ubuntu</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/centos-installation/">OpenID Connect RP in CentOS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/oxray/">OpenID Connect Liferay Plugin</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/apache-saml/">SAML SP in CentOS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/ubuntu-shib-apache/">SAML SP in Ubuntu</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/iis-saml/">SAML SP in IIS7</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/saml-windows/">SAML SP in Windows</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Integration Guides</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/google-saml/">Google SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/office365/">Office 365 SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/hobsons-saml/">Hobsons Education Solution SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/salesforce-sso/">Salesforce SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/dropbox/">Dropbox SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/test-shib2/">TestShib2 SSO</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../integrate/asimba/">Asimba & Gluu CE</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Fine Tuning and Benchmarking</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../fine-tuning/">Tuning LDAP, Tomcat</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Gluu Defaults</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/policy/">Gluu Policy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/config/">Configurations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/certificates/">Certificates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/ldap/">LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/logout/">Logout</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/schema/">Schema</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/oxtrust-properties/">oxTrust Properties File</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/oxauth-properties/">oxAuth Properties File</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gluu-defaults/logs/">Logs</a>
        
    </li>

        
    </ul>
<li>
		
          
			
            <li>
    <ul class="subnav">
    <li><span>Gluu Server API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-authorization/">OpenID Connect Authorization Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-token/">OpenID Connect Token Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-userinfo/">OpenID Connect UserInfo Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-register-client/">OpenID Connect Client Registration Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-end-session/">OpenID Connect End Session Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/oic-clientinfo/">OpenID Connect Client Info Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-discovery/">UMA Discovery Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-authorization-endpoint/">UMA Authorization Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-resource-registration/">UMA Resource Registration Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-permission-registration/">UMA Permission Registration Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-create-rpt/">UMA CreateRPT Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/uma-rpt-status/">UMA RPT Introspection Endpoint</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/id-generation/">Custom ID Generation API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/scim-1.1/">SCIM 1.1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../api/scim-2.0/">SCIM 2.0</a>
        
    </li>

        
    </ul>
<li>
		
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Gluu Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Authentication &raquo;</li>	 
        
      
    
    <li>Google Authentication</li>
    <li class="wy-breadcrumbs-aside">
           
      
        
          <a href="https://github.com/GluuFederation/docs/blob/master/sources/customize/social-login-google.md" class="icon icon-github"> Edit on GitHub</a>
      
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="configure-google">Configure Google</h1>
<p>In order to call Google API's, you need to register as a developer and
create client credentials. Here are some
<a href="https://developers.google.com/identity/protocols/OAuth2">instructions</a>
for these steps.</p>
<p>The first thing you'll need to do is Create a Project on Google to obtain
client credentials. Click "Create project" and enter your desired
project name.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/01-create-project.png" /></p>
<p>Then click on your newly created project from the listing on the
dashboard, and under the Credentials section, create a new "OAuth2 2.0
client ID". </p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/02-create-oauth2-creds.png" /></p>
<p>Google will ask you to configure your consent screen, to add your logo
and other information displayed to the user to authorize Google to
release information.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/03-create-oauth2-creds.png" /></p>
<p>Fill out the form...</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/04-configure-authorization-page.png" /></p>
<p>Now you're ready to create the credentials. Enter "Authorized JavaScript
origins". It should be the uri of your Gluu Server--for example
<code>https://idp.example.com</code>.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/05-create-oauth2-creds.png" /></p>
<p>Google will display the client-id and the according secret ... ignore
it. Instead, download the JSON file which you are going to upload into
your Gluu Server, next.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/06-download_json.png" /></p>
<p>Move this file to the location <code>/opt/tomcat/conf/google.json</code>. The JSON
file will look something like this example (no... these data are not
valid credentials!):</p>
<pre><code class="json">{
  &quot;web&quot;: {
    &quot;client_id&quot;: &quot;7a64e55f-724d4e8c91823d5f1f18a0b2.apps.googleusercontent.com&quot;,
    &quot;auth_uri&quot;: &quot;https:\/\/accounts.google.com\/o\/oauth2\/auth&quot;,
    &quot;token_uri&quot;: &quot;https:\/\/accounts.google.com\/o\/oauth2\/token&quot;,
    &quot;auth_provider_x509_cert_url&quot;: &quot;https:\/\/www.googleapis.com\/oauth2\/v1\/certs&quot;,
    &quot;client_secret&quot;: &quot;bb76a2c99be94e35b874&quot;,
    &quot;javascript_origins&quot;: [
      &quot;https:\/\/brookie.gluu.info&quot;
    ]
  }
}
</code></pre>

<p>The last step is to enable Google+ API's:</p>
<ul>
<li>Navigate back to the Google API <a href="https://console.developers.google.com/project">console</a></li>
<li>Select project and enter project name</li>
<li>Open new project "API &amp; auth -&gt; API" menu item in configuration navigation tree</li>
<li>Click "Google+ API"</li>
<li>Click "Enable API" button</li>
</ul>
<h2 id="configure-gluu-server">Configure Gluu Server</h2>
<p>Login to oxTrust, and navigate to "Configure Custom Scripts".</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/06-manage-custom-scripts.png" /></p>
<p>At the bottom of the page, click on the link to "Add custom script
configuration".</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/07-add_custom_script.png" /></p>
<p>In the main body of the "Custom Script" section, paste the <a href="https://raw.githubusercontent.com/GluuFederation/oxAuth/master/Server/integrations/gplus/GooglePlusExternalAuthenticator.py">code from
github</a>.</p>
<p>You'll also need to add some custom properties:</p>
<ul>
<li><strong>gplus_client_secrets_file</strong>: <code>/opt/tomcat/conf/google.json</code></li>
<li><strong>gplus_deployment_type</strong>: enroll</li>
<li><strong>gplus_remote_attributes_list</strong>: email, given_name, family_name, and locale</li>
<li>
<p><strong>gplus_local_attributes_list</strong>: uid, mail, givenName, sn, cn, preferredLanguage</p>
</li>
<li>
<p><strong>gplus_client_secrets_file</strong> - It is a mandatory property that holds
   the path to the application configuration file downloaded from Google
   console for application. An example is <code>/etc/certs/gplus_client_secrets.json</code>.
   These are the single steps needed to get it:
    a) Log into: <code>https://console.developers.google.com/project</code>
    b) Click "Create project" and enter project name
    c) Open new project "API &amp; auth -&gt; Credentials" menu item in configuration navigation tree
    d) Click "Add credential" with type "OAuth 2.0 client ID"
    e) Select "Web application" application type
    f) Enter "Authorized JavaScript origins". It should be CE server DNS
       name, for example <code>https://gluu.info</code>.
    g) Click "Create" and Click "OK" in next dialog
    h) Click "Download JSON" in order to download
       <code>gplus_client_secrets.json</code> file.
    Also it is mandatory to enable Google+ API:
    a) Log into <code>https://console.developers.google.com/project</code>
    b) Select project and enter project name
    c) Open new project "API &amp; auth -&gt; API" menu item in configuration navigation tree
    d) Click "Google+ API"
    e) Click "Enable API" button</p>
</li>
<li>
<p><strong>gplus_deployment_type</strong> - Specify the deployment mode. It is an
optional property. If this property isn't specified the script tries to
find the user in the local LDAP by 'subject_identifier' claim specified
in id_token. If this property has a 'map' value the script allows to map
'subject_identifier' to the local user account. If this property has an
'enroll' value the script adds a new user to the local LDAP with status
'active'. In order to map the IDP attributes to the local attributes it
uses properties from both gplus_remote_attributes_list and
gplus_local_attributes_list. The allowed values are map and enroll.</p>
</li>
<li>
<p><strong>gplus_remote_attributes_list</strong> - Comma-separated list of attribute
names (user claims) that Google+ returns which map to local attributes
in the <code>gplus_local_attributes_list</code> property. It is mandatory only if
<code>gplus_deployment_type</code> is set to 'enroll'.</p>
</li>
<li>
<p><strong>gplus_local_attributes_list</strong> - Comma-separated list of Gluu Server
LDAP attribute names that are mapped to Google user claims from the
<code>gplus_remote_attributes_list</code> property. It is mandatory only if
<code>gplus_deployment_type</code> is set to 'enroll'.</p>
</li>
<li>
<p><strong>extension_module</strong> - Optional property to specify the full path of
an external module that implements two methods:</p>
</li>
</ul>
<pre><code class="python">    # This is called when the authentication script initializes
    def init(conf_attr):
        # Code here
        return True/False

    # This is called after authentication
    def postLogin(conf_attr, user):
        # Code here
        return True    # or return False
</code></pre>

<ol>
<li><strong>gplus_client_configuration_attribute</strong> - Optional property to
specify the client entry attribute name which can override
<code>gplus_client_secrets_file file</code> content. It can be used in cases when
all clients should use a separate <code>gplus_client_secrets.json</code>
configuration.</li>
</ol>
<h2 id="testing">Testing</h2>
<p>One simple way to test the configuration is to use oxTrust. In the
"Configure Authentication" dropdown menu, select "Google" (or whatever
you entered as the "Name" of the custom authentication script--as the
default authentication method.</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/08-select_default_authentication.png" /></p>
<p>After you login and logout, you should be presented with a new login
form that has the Google login button:</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/09-google-authentication-button.png" /></p>
<p>After clicking the Google login button, you are presented for
authorization--Google needs to make sure its ok to release attributes to
the Gluu Server:</p>
<p><img alt="image" src="https://raw.githubusercontent.com/GluuFederation/docs/master/sources/img/google_login/10-google-authorization.png" /></p>
<p>If the script doesn't work, and you locked yourself out of oxTrust,
don't worry! You can create an LDIF file, for example <code>revert.ldif</code>, to
set back the default authentication method, like this:</p>
<pre><code>dn: inum=@!1E3B.F133.14FA.5062!0002!4B66.CF9C,ou=appliances,o=gluu
changetype: modify
replace: oxAuthenticationMode
oxAuthenticationMode: internal
</code></pre>

<p>oxAuthenticationMode corresponds to the 'Name' of the customer
authentication script in oxTrust. Use <code>internal</code> to revert to the
default LDAP authentication. You'll have to change the <code>inum</code> with the
<code>inum</code> of your installation. You can find it using ldapsearch like this:</p>
<pre><code>/opt/opendj/bin/ldapsearch -h localhost -p 1389 -D &quot;cn=directory manager&quot; -j ~/.pw -b &quot;ou=appliances,o=gluu&quot; -s one &quot;objectclass=*&quot; inum
</code></pre>

<p><code>~/.pw</code> is a file with your Directory Manager password. If you don't
remember it, try to find it using <code>grep</code>: </p>
<pre><code>grep ldapPass= /install/community-edition-setup/setup.properties.last
</code></pre>

<p>Once your LDIF looks ok, then use <code>ldapmodify</code> to revert back to
password authentication:</p>
<pre><code>/opt/opendj/bin/ldapmodify -h localhost -p 1389 -D &quot;cn=directory manager&quot; -j ~/.pw -f revert.ldif
</code></pre>

<p>If things go wrong, it can leave the sessions in your browser in a bad
state. If things get really weird, remove the cookies in your browser
for the hostname of your Gluu Server.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../faq/general/" class="btn btn-neutral float-right" title="General"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../multi-factor/cert/" class="btn btn-neutral" title="Certificate"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../multi-factor/cert/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../faq/general/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
